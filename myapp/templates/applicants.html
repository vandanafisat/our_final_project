
{% load static %}

<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Applicants</title>
    <style>
    body{
      background-size: cover;
      background-attachment: fixed;
      zoom:95%;
    }
      table{
        opacity: 75%;
      }
      .table .btn{
        margin:5px;
      }
      td{
        font-size: 15px;
      }
      th, td{
        padding: 10px;
        text-align: center;
      }
      th{
        background-color: #0f52ba;
        color: #FFFFFF;
      }
      tr{
        background-color: #fce6cc
;
      }
      .xyz {
        margin-left: 250px;
        margin-top: 30px;
      }
    </style>
    <link type="text/css" href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet"/>
    <link rel="shortcut icon" href="{% static 'rt.jpg' %}" />


  </head>
  <body style="background-color:#fff9f2;">



    <p><br /></p>
    <div class="conatiner">
      <p></p>
      <button class="btn btn-success btn-lg xyz col-xs-offset-1 col-md-offset-1 col-sm-offset-1 col-lg-offset-1" data-toggle="modal" data-target="#adddata" onClick='myfun1()' style="background-color: #0f52ba;border-color: #0f52ba;">New Profiles</button>
      <br><br><br><br>
        <!-- Modal -->
        <div class="modal fade col-xs-12" id="adddata" tabindex="-1" role="dialog" aria-labelledby="addLabel">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
                                    <div class="modal-header">
                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                      <h3 class="modal-title" id="addLabel">New Applicant</h3>
                                    </div>
                                    <form action="" method="post" id="form_id1">
                                    {% csrf_token %}
                                    <div class="modal-body">
                                      <div class="form-group">
                                        <label for="A">RGS ID</label>
                                        <input type="text" class="form-control" name="A" id="A" value='{{search_query}}' readonly>
                                      </div>

                                      <div class="form-group">
                                        <label for="B">Date of tracker</label>
                                        <input type="date" class="form-control" name="B" id="B" placeholder="Date of tracker">
                                      </div>
                                      <div class="form-group">
                                        <label for="C">Branch</label>
                                        <input type="text" class="form-control" name="C" id="C" placeholder="Branch">
                                      </div>
                                      <div class="form-group">
                                        <label for="D">Who sourced the cv -Name</label>
                                        <input type="text" class="form-control" name="D" id="D" placeholder="Who sourced the cv -Name">
                                      </div>
                                      <div class="form-group">
                                        <label for="E">Who sourced the cv -Employee number</label>
                                        <input type="text" class="form-control" name="E" id="E" placeholder="Who sourced the cv -Employee number">
                                      </div>
                                      <div class="form-group">
                                        <label for="F">Candidate name</label>
                                        <input type="text" class="form-control" name="F" id="F" placeholder="Candidate name">
                                      </div>
                                      <div class="form-group">
                                        <label for="G">EP number</label>
                                        <input type="text" class="form-control" name="G" id="G" placeholder="EP number">
                                      </div>
                                      <div class="form-group">
                                        <label for="H">Source details</label>
                                        <input type="text" class="form-control" name="H" id="H" placeholder="Source details">
                                      </div>
                                      <div class="form-group">
                                        <label for="I">Main skills</label>
                                        <input type="text" class="form-control" name="I" id="I" placeholder="Main skills">
                                      </div>
                                      <div class="form-group">
                                        <label for="J">ISU Name</label>
                                        <input type="text" class="form-control" name="J" id="J" placeholder="ISU Name">
                                      </div>
                                      <div class="form-group">
                                        <label for="K">Customer name</label>
                                        <input type="text" class="form-control" name="K" id="K" placeholder="Customer name">
                                      </div>
                                      <div class="form-group">
                                        <label for="L">Weekend/Weekday</label>
                                        <input type="text" class="form-control" name="L" id="L" placeholder="Weekend/Weekday">
                                      </div>
                                      <div class="form-group">
                                        <label for="M">Date of interview</label>
                                        <input type="date" class="form-control" name="M" id="M" placeholder="Date of interview">
                                      </div>
                                      <div class="form-group">
                                        <label for="N">Status</label>
                                        <input type="text" class="form-control" name="N" id="N" placeholder="Status">
                                      </div>
                                      <div class="form-group">
                                        <label for="O">Contact number</label>
                                        <input type="text" class="form-control" name="O" id="O" placeholder="Contact number">
                                      </div>
                                      <div class="form-group">
                                        <label for="P">Email ID</label>
                                        <input type="email" class="form-control" name="P" id="P" placeholder="Email ID">
                                      </div>
                                      <div class="form-group">
                                        <label for="Q">Total yrs of experience </label>
                                        <input type="text" class="form-control" name="Q" id="Q" placeholder="Total yrs of experience">
                                      </div>
                                      <div class="form-group">
                                        <label for="R">R.experience</label>
                                        <input type="text" class="form-control" name="R" id="R" placeholder="R.experience">
                                      </div>
                                      <div class="form-group">
                                        <label for="S">Current Organisation</label>
                                        <input type="text" class="form-control" name="S" id="S" placeholder="Current Organisation">
                                      </div>
                                      <div class="form-group">
                                        <label for="T">Current Location</label>
                                        <input type="text" class="form-control" name="T" id="T" placeholder="Current Locaion">
                                      </div>
                                      <div class="form-group">
                                        <label for="U">Prefered Location </label>
                                        <input type="text" class="form-control" name="U" id="U" placeholder="Prefered Location">
                                      </div>
                                      <div class="form-group">
                                        <label for="V">Current CTC</label>
                                        <input type="text" class="form-control" name="V" id="V" placeholder="Current CTC">
                                      </div>
                                      <div class="form-group">
                                        <label for="W">Expected CTC</label>
                                        <input type="text" class="form-control" name="W" id="W" placeholder="Expected CTC">
                                      </div>
                                      <div class="form-group">
                                        <label for="X">Notice period</label>
                                        <input type="text" class="form-control" name="X" id="X" placeholder="Notice period">
                                      </div>
                                      <input type="hidden" name="sou_id" id="sou_id" value="hello">
                                      <input type="submit" value="Submit"/>
                                      </form>


                        <div class="modal-footer">
                        <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Close</button>
                        <!--<button type="button" onclick="save_data()"  class="btn btn-primary btn-sm">Save</button> <data-dismiss="modal"-->
                       </div>

            </div>
          </div>
        </div>
        <div id="result"></div>
      <p></p>
    </div>

               <div class="container">
                    <h1 align="center"><strong style="color: #0f52ba;" >Profiles</strong></h1>
                    <br />
                    <div id="main"></div>
                    <div class="table-responsive">
                         <table id="trip_data" class="table table-striped table-bordered">
                              <thead>
                                   <tr>
                                        <th>Options</th>
                                        <th>RGS ID</th>
                                        <th>Branch</th>
                                        <th>Candidate Nam</th>
                                        <th>EP number</th>
                                        <th>Main Skills</th>
                                        <th>Date of interview</th>
                                        <th>Status</th>
                                        <th>Contact number</th>
                                        <th>Email ID</th>
                                        <th>Total yrs of experience</th>
                                        <th>Expected CTC</th>
                                   </tr>
                              </thead>

                            {% for i in sources %}
                                <tr>
                                    <td>
                                    <p>
                                    <a data-toggle="modal" data-target="#adddata" onclick='myfun("{{i.id}}")'>
                                    <span class="glyphicon glyphicon-pencil"></span>
                                    </a>
                                    </p>
                                    <p>
                                    <a onclick='del("{{i.id}}")' data-toggle="modal" data-target="#delinfo">
                                    <span class="glyphicon glyphicon-trash"></span>
                                    </a>
                                    </p>
                                    <button type="button" data-toggle="modal" data-target="#viewmore" class="btn btn-primary btn-xs" onclick='viewfun("{{i.id}}")'>View More</button>
                                    </td>
                                    <td>{{i.RGS_ID}}</td>
                                    <td>{{i.branch}}</td>
                                    <td>{{i.cand_name}}</td>
                                    <td>{{i.epno}}</td>
                                    <td>{{i.main_skills}}</td>
                                    <td>{{i.dt_of_interview|date:"D d M Y"}}</td>
                                    <td>{{i.status}}</td>
                                    <td>{{i.contact_number}}</td>
                                    <td>{{i.email_id}}</td>
                                    <td>{{i.tot_yrs_exp}}</td>
                                    <td>{{i.exp_ctc}}</td>
                                </tr>
                            {% endfor %}



                         </table>
                </div>
               </div>
               </div>
               </div>
               </div>
                <p><br /></p>
                  <p><br /></p>

                  <!-- Modal -->
        <div class="modal fade" id="viewmore" tabindex="-1" role="dialog" aria-labelledby="addLabel">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
                                    <div class="modal-header">
                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                      <h3 class="modal-title" id="addLabel">Additional Data</h3>
                                    </div>
                                    <form action="" method="post" id="form_id3">
                                    {% csrf_token %}
                                    <div class="modal-body">


                                      <div class="form-group">
                                        <label for="Aa">TR Status</label>
                                        <br>
  											<select class="data-list-input" name ="Aa" id="Aa" style="width:570px; height:35px;">
  													<option value="-">-</option>
    												<option value="Yes">Yes</option>
    												<option value="No">No</option>

											</select>
                                      </div>
                                      <div class="form-group">
                                        <label for="Bb">MR Status</label>
                                        <br>
  											<select class="data-list-input" name ="Bb" id="Bb" style="width:570px; height:35px;">
  													<option value="-">-</option>
    												<option value="Yes">Yes</option>
    												<option value="No">No</option>

											</select>
                                      </div>
                                      <div class="form-group">
                                        <label for="Cc">HR Status</label>
                                        <br>
  											<select class="data-list-input" name ="Cc" id="Cc" style="width:570px; height:35px;">\
  													<option value="-">-</option>
    												<option value="Yes">Yes</option>
    												<option value="No">No</option>

											</select>
                                      </div>
                                      <div class="form-group">
                                        <label for="Dd">Offer made</label>
                                        <br>
  											<select class="data-list-input" name ="Dd" id="Dd" style="width:570px; height:35px;" onchange='yesnoCheck(this);'>
  													<option value="-">-</option>
    												<option value="Yes">Yes</option>
    												<option value="No">No</option>


											</select>
                                      </div>
                                      <div class="form-group" id="ifYes" style="display: none;">
                                        <label for="Ee">DOJ</label>
                                        <input type="date" class="form-control" name="Ee" id="Ee" placeholder="DOJ">
                                      </div>

                                      <input type="hidden" name="sou_id1" id="sou_id1" value="hello">
                                      <input type="submit" value="Submit"/>
                                      </form>


                        <div class="modal-footer">
                        <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Close</button>
                        <!--<button type="button" onclick="save_data()"  class="btn btn-primary btn-sm">Save</button> <data-dismiss="modal"-->
                       </div>

            </div>
          </div>
        </div>
        <div id="result"></div>
      <p></p>
    </div>

    <form id="form_delete" method="post" action="">
        {% csrf_token %}
        <input type="hidden" name="del_id" id="del_id" value="">
    </form>

                      <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
                      <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
                      <!--[if lt IE 9]>
                        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
                        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
                      <![endif]-->
              <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
              <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
              <!-- Include all compiled plugins (below), or include individual files as needed -->
              <script src="{% static 'js/bootstrap.min.js' %}"></script>
              <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
              <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
              <script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
              <link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css" />
              <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
              <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
              <script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
              <script src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>
              <link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css" />


  </body>
</html>
<script>
var flag =0;
function yesnoCheck(that) {
        if (that.value == "Yes") {

            document.getElementById("ifYes").style.display = "block";
            if(flag==1)
            {
              alert("Two offers made already!");
              $("#Dd").val('No');
              document.getElementById("ifYes").style.display = "none";
              flag=0;
            }
        } else {
            document.getElementById("ifYes").style.display = "none";
        }
    }

function viewfun(h)
{
	document.getElementById("sou_id1").value = h;
	{% for k in sources %}
		var personArray,rgsid;
    	personArray = {{k.id}};
      if(personArray == h)
    	{

        rgsid = '{{k.RGS_ID}}';
    		$("#Aa").val('{{k.TR_status}}');
    		$("#Bb").val('{{k.MR_status}}');
    		$("#Cc").val('{{k.HR_status}}');
    		$("#Dd").val('{{k.offers_made}}');
			$("#Ee").val(formatDate('{{k.DOJ|date:"D d M Y"}}'));
		}
	{% endfor %}
  var offers = {{approvals.No_offers_processed}};
  if(offers==2)
  {
    //alert(document.getElementById("Dd").value);
    if(document.getElementById("Dd").value == '-'|| document.getElementById("Dd").value == 'No')
    {
      $("#Dd").val('No');
      flag=1;
    }
  }
  var check = document.getElementById("Dd").value;
	if (check == "Yes") {
            document.getElementById("ifYes").style.display = "block";
        } else {
            document.getElementById("ifYes").style.display = "none";
        }
}

function myfun1(){
	document.getElementById("form_id1").reset();
}

function formatDate(date) {
    var d = new Date(date),
        month = '' + (d.getMonth() + 1),
        day = '' + d.getDate(),
        year = d.getFullYear();

    if (month.length < 2) month = '0' + month;
    if (day.length < 2) day = '0' + day;

    return [year, month, day].join('-');
}


function myfun(h){
  //do your ajax call here

  {% for person in sources %}
    var personArray ;
    personArray = {{person.id}};
    if(personArray == h)
    {
      //alert('{{person.ass_date|date:"D d M Y"}}');
      document.getElementById("A").value='{{person.RGS_ID}}';
      document.getElementById("B").value=formatDate('{{person.DOT|date:"D d M Y"}}');
      document.getElementById("C").value='{{person.branch}}';
      document.getElementById("D").value='{{person.who_sourced_name}}';
      document.getElementById("E").value='{{person.who_sourced_eno}}';
      document.getElementById("F").value='{{person.cand_name}}';
      document.getElementById("G").value='{{person.epno}}';
      document.getElementById("H").value='{{person.source_dtls}}';
      document.getElementById("I").value='{{person.main_skills}}';
      document.getElementById("J").value='{{person.ISU_name}}';
      document.getElementById("K").value='{{person.customer_name}}';
      document.getElementById("L").value='{{person.weekend_weekday}}';
      document.getElementById("M").value=formatDate('{{person.dt_of_interview|date:"D d M Y"}}');
      document.getElementById("N").value='{{person.status}}';
      document.getElementById("O").value='{{person.contact_number}}';
      document.getElementById("P").value='{{person.email_id}}';
      document.getElementById("Q").value='{{person.tot_yrs_exp}}';
      document.getElementById("R").value='{{person.R_exp}}';
      document.getElementById("S").value='{{person.current_org}}';
      document.getElementById("T").value='{{person.current_loc}}';
      document.getElementById("U").value='{{person.pref_loc}}';
      document.getElementById("V").value='{{person.current_ctc}}';
      document.getElementById("W").value='{{person.exp_ctc}}';
      document.getElementById("X").value='{{person.notice_period}}';
    }
  {% endfor %}
  document.getElementById("sou_id").value = h;
  //alert(document.getElementById("sou_id").value)
  //input.next('span.info').html(input.val());
}

$(document).ready(function(){
    flag=0;
     $('#trip_data').DataTable();
});
function ref_data(){
  location.reload();
}
function del(elem1){
  var r = confirm("Are you sure, you want to delete");
    if (r == true) {
        document.getElementById("del_id").value = elem1;
        document.getElementById("form_delete").submit();

    }
}


</script>
